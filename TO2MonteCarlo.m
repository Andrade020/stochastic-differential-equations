%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% LUCAS ANDRADE %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% %%%%%%%%%%%%%%%%%%%%%%%%%%% hiperparametros %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
T = 2;             % Tempo final
M = 10000;         % Número de trajetórias para a simulação de Monte Carlo
x0 = 0.5;          % Valor inicial de X
X2 = zeros(M, 1);
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Monte Carlo %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
for j = 1:M
    W = sqrt(T) * randn;  % Realização do movimento Browniano em t = 2
    % Calculando a solução exata para esta realização
    X = ((1 + x0) * exp( W) + x0 - 1) / ((1 + x0) * exp(2 *W) + 1 - x0);
    X2(j) = X^2;  % Armazenar o quadrado do valor
end
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Calcula media %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
E_X2 = mean(X2);
disp(['E[X^2(2)] = ', num2str(E_X2)]); %printa
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%